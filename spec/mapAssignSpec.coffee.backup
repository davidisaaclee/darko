mapAssign = require '../src/util/mapAssign'

describe 'mapAssign', () ->
  it 'can modify shallow properties', () ->
    src = a: 0
    result = mapAssign {}, src, 'a', () -> 1

    expect src
      .toEqual a: 1
    expect src
      .toEqual a: 0

  it 'can assign shallow properties', () ->
    src = {}
    result = mapAssign {}, src, 'a', () -> 1

    expect result
      .toEqual a: 1
    expect src
      .toEqual {}


  it 'can assign deep properties to existing properties', () ->
    src = a: {}
    result = mapAssign {}, src, 'a.b', () -> 0

    expect result
      .toEqual a: {b: 0}
    expect src
      .toEqual a: {}


  it 'can assign deep properties to nonexistant properties', () ->
    src = {}
    result = mapAssign {}, src, 'a.b', () -> 0

    expect result
      .toEqual a: {b: 0}
    expect src
      .toEqual {}


  it 'can assign over objects', () ->
    src =
      a: 1
      b: 2
      c: 3
    result = mapAssign {}, src, '*', () -> 0

    expect result
      .toEqual
        a: 0
        b: 0
        c: 0
    expect src
      .toEqual
        a: 1
        b: 2
        c: 3